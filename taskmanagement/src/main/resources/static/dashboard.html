<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Dashboard</title>
    <link rel="stylesheet" href="styles.css">
</head>

<body>

    <header class="navbar">
        <div class="logo">TMS</div>

        <nav>
            <!-- <a href="index.html">Home</a>
            <a href="features.html">Features</a> -->
            <a href="tasks.html" class="task-btn">Tasks</a>
            <button class="logout-btn" onclick="logout()">Logout</button>
            <button id="themeToggle" class="theme-btn">üåô</button>
            <script>

                function logout() {
                    localStorage.removeItem("user");
                    window.location.href = "login.html";
                }

            </script>
        </nav>
    </header>
    <main>
        <section class="dashboard">
            <h1>DashBoard</h1>
            <div class="board">

                <div class="column">
                    <h3>To Do</h3>
                    <div id="todoList"></div>
                </div>

                <div class="column">
                    <h3>In Progress</h3>
                    <div id="progressList"></div>
                </div>

                <div class="column">
                    <h3>Completed</h3>
                    <div id="doneList"></div>
                </div>

            </div>

        </section>
    </main>
    <footer class="footer">
        <p class="copyright">
            ¬© 2026 Abhishek. All rights reserved.
        </p>
    </footer>
</body>

</html>
<script>

    const user = localStorage.getItem("user");

    if (!user) {
        window.location.href = "login.html";
    }

</script>
<script>

    const toggleBtn = document.getElementById("themeToggle");

    if (localStorage.getItem("theme") === "dark") {
        document.body.classList.add("dark");
        toggleBtn.textContent = "‚òÄÔ∏è";
    }

    toggleBtn.onclick = () => {

        document.body.classList.toggle("dark");

        if (document.body.classList.contains("dark")) {
            localStorage.setItem("theme", "dark");
            toggleBtn.textContent = "‚òÄÔ∏è";
        } else {
            localStorage.setItem("theme", "light");
            toggleBtn.textContent = "üåô";
        }

    };

</script>
<script>

    async function loadDashboardTasks() {

        const user = JSON.parse(localStorage.getItem("user"));

        const res = await fetch(`http://localhost:8080/api/tasks/user/${user.id}`);
        const tasks = await res.json();

        document.getElementById("todoList").innerHTML = "";
        document.getElementById("progressList").innerHTML = "";
        document.getElementById("doneList").innerHTML = "";

        tasks.forEach(task => {

            const div = document.createElement("div");
            div.className = "task";

            div.innerHTML = `
            <b>${task.title}</b>
            <p>${task.deadline ?? ""}</p>
            `;

            if (task.status === "TODO")
                document.getElementById("todoList").appendChild(div);

            if (task.status === "PROGRESS")
                document.getElementById("progressList").appendChild(div);

            if (task.status === "DONE")
                document.getElementById("doneList").appendChild(div);

        });

    }

    loadDashboardTasks();

</script>